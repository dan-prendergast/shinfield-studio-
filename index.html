<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shinfield Studios — Visitor Map & Amenities</title>
  <meta name="description" content="Visitor-friendly map of key amenities around Shinfield Studios with driving distances and times." />

  <!-- Tailwind (CDN) for styling -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet (original map library, no API key required) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    html, body { height: 100%; }
    #map { height: 100%; min-height: 480px; }
    .leaflet-popup-content { font-size: 0.95rem; }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <!-- Header -->
  <header class="w-full border-b bg-white">
    <div class="max-w-7xl mx-auto px-4 py-6 flex flex-col gap-4 items-center text-center">
      <h1 class="text-4xl font-bold text-indigo-700">Shinfield Studios — Visitor Map & Amenities</h1>
      <p class="text-base text-slate-600">Key amenities with approximate driving distance (mi) & time (min) from the studio.</p>
      <div class="w-full">
        <a href="https://shinfieldstudios.com/wp-content/uploads/2025/01/ARC-5221-Shinfield-Studios-MAP-R6-JUN-2024-A0.svg" target="_blank" rel="noopener noreferrer">
          <img src="https://shinfieldstudios.com/wp-content/uploads/2025/01/ARC-5221-Shinfield-Studios-MAP-R6-JUN-2024-A0.svg" alt="Shinfield Studios Site Map (High Resolution SVG)" class="w-full max-h-96 object-contain rounded shadow hover:opacity-90" />
        </a>
        <p class="text-xs text-slate-500 mt-1">Click the map to view full size in a new tab.</p>
      </div>
      <div class="text-xs text-slate-500">
        <span>Last updated: Sep 2025</span>
      </div>
    </div>
  </header>

  <!-- Layout -->
  <main class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-4 p-4">
    <!-- Map (Leaflet) -->
    <section class="lg:col-span-2 h-[70vh] lg:h-[78vh] rounded-2xl overflow-hidden shadow relative">
      <div id="map"></div>
      <noscript>
        <div class="p-4 text-sm text-red-700">This map requires JavaScript. Please enable it in your browser.</div>
      </noscript>
    </section>

    <!-- Sidebar: Suggested Amenities & POI list -->
    <aside class="lg:col-span-1 bg-white rounded-2xl shadow divide-y">
      <div class="p-4">
        <h2 class="text-lg font-semibold mb-2">Suggested Amenities</h2>
        <ol class="list-decimal list-inside space-y-1 text-sm">
          <li><strong>Immediate essentials (0–5 min)</strong>: Tesco Express; Esso Petrol; Shinfield Pharmacy.</li>
          <li><strong>Lower Earley cluster (~6 min)</strong>: McDonald’s; M&S Simply Food; Greggs (all at The Square / Chalfont Way).</li>
          <li><strong>Larger needs</strong>: Morrisons (full shop); Screwfix (tools & fixings).</li>
          <li><strong>Health & emergencies</strong>: Royal Berkshire Hospital; Pharmacy for minor needs.</li>
          <li><strong>Alternative fuel</strong>: ASDA Petrol (Chalfont Way, 24-h).</li>
        </ol>
      </div>
      <div class="p-4">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-lg font-semibold">All Amenities</h3>
          <label class="text-xs text-slate-600">Sort by
            <select id="sortSelect" class="ml-1 border rounded px-2 py-1 text-xs">
              <option value="distance">Distance (mi)</option>
              <option value="time">Drive time (min)</option>
              <option value="name">Name (A–Z)</option>
            </select>
          </label>
        </div>
        <ul id="poiList" class="space-y-2 text-sm"></ul>
      </div>
    </aside>
  </main>

  <footer class="max-w-7xl mx-auto px-4 pb-6 text-xs text-slate-500 text-center">
    <p>
      Map data © OpenStreetMap contributors. Distances & times are approximate (typical traffic). No API keys required.
    </p>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const studio = { name: "Shinfield Studios", lat: 51.415496, lng: -0.938695 };

      const pois = [
        { name: "Tesco Express (203–207 Shinfield Rd)", category: "Supermarket", lat: 51.427981, lng: -0.945786, distanceMi: 0.2, driveMin: 2 },
        { name: "Esso Petrol (211 Shinfield Rd)", category: "Petrol", lat: 51.42787, lng: -0.94560, distanceMi: 0.3, driveMin: 2 },
        { name: "Shinfield Pharmacy (School Green)", category: "Pharmacy", lat: 51.40419, lng: -0.94874, distanceMi: 0.5, driveMin: 3 },
        { name: "McDonald’s (The Square, Lower Earley)", category: "Fast Food", lat: 51.423233, lng: -0.934716, distanceMi: 2.0, driveMin: 6 },
        { name: "M&S Simply Food (3 The Square, Lower Earley)", category: "Supermarket", lat: 51.423016, lng: -0.9349004, distanceMi: 2.0, driveMin: 6 },
        { name: "Greggs (Chalfont Way, Lower Earley)", category: "Bakery/Coffee", lat: 51.42457, lng: -0.93274, distanceMi: 2.1, driveMin: 6 },
        { name: "Morrisons (Basingstoke Rd)", category: "Supermarket", lat: 51.434118, lng: -0.970483, distanceMi: 1.0, driveMin: 4 },
        { name: "Screwfix (Tilehurst, Stadium Way)", category: "Hardware/DIY", lat: 51.463272, lng: -1.013296, distanceMi: 4.1, driveMin: 11 },
        { name: "Royal Berkshire Hospital (London Rd)", category: "Hospital", lat: 51.449038, lng: -0.958427, distanceMi: 1.0, driveMin: 4 },
        { name: "ASDA Petrol (Chalfont Way, Lower Earley)", category: "Petrol", lat: 51.423325, lng: -0.9324726, distanceMi: 1.5, driveMin: 5 }
      ];

      const map = L.map('map').setView([studio.lat, studio.lng], 14);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      const studioMarker = L.marker([studio.lat, studio.lng]).addTo(map);
      studioMarker.bindPopup(`<strong>${studio.name}</strong><br>South Avenue, RG2 9LH`);

      const list = document.getElementById('poiList');
      const markers = [];

      function addMarker(p) {
        const m = L.marker([p.lat, p.lng]).addTo(map);
        m.bindPopup(`<strong>${p.name}</strong><br><em>${p.category}</em><br>${p.distanceMi.toFixed(1)} mi · ~${p.driveMin} min drive<br><a href='https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(studio.name)}&destination=${encodeURIComponent(p.name)}' target='_blank' rel='noopener noreferrer' class='text-indigo-600 underline'>Directions from Studio</a>`);
        markers.push(m);
      }

      pois.forEach(addMarker);

      const group = L.featureGroup(markers.concat(studioMarker));
      map.fitBounds(group.getBounds().pad(0.15));

      function renderList(sortBy = 'distance') {
        const items = [...pois];
        if (sortBy === 'distance') items.sort((a,b) => a.distanceMi - b.distanceMi);
        if (sortBy === 'time') items.sort((a,b) => a.driveMin - b.driveMin);
        if (sortBy === 'name') items.sort((a,b) => a.name.localeCompare(b.name));

        list.innerHTML = '';
        items.forEach(p => {
          const li = document.createElement('li');
          li.className = 'border rounded-xl p-3 hover:bg-slate-50 cursor-pointer';
          li.innerHTML = `
            <div class="text-sm font-medium">${p.name}</div>
            <div class="text-xs text-slate-600">${p.category} • ${p.distanceMi.toFixed(1)} mi • ~${p.driveMin} min</div>
            <a href='https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(studio.name)}&destination=${encodeURIComponent(p.name)}' target='_blank' rel='noopener noreferrer' class='text-indigo-600 underline text-xs'>Directions from Studio</a>
          `;
          li.addEventListener('click', () => {
            map.flyTo([p.lat, p.lng], 16, { duration: 0.6 });
            const mk = markers.find(mk => {
              const pos = mk.getLatLng();
              return Math.abs(pos.lat - p.lat) < 1e-6 && Math.abs(pos.lng - p.lng) < 1e-6;
            });
            mk && mk.openPopup();
          });
          list.appendChild(li);
        });
      }

      renderList('distance');
      document.getElementById('sortSelect').addEventListener('change', (e) => renderList(e.target.value));
    });
  </script>
</body>
</html>
